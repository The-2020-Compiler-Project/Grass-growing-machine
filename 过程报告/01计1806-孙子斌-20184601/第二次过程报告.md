撰写完成时间：2020.7.9 1:25

计1806 孙子斌

# 第二次过程报告

## 对于小组的工作安排

### 小组在本阶段完成

1. 词法分析器的修正与完善
2. 语义分析的修正与完善
3. 目标代码（8086汇编）生成模块实现
4. 四元式列表输出、符号表输出函数

### 小组正在进行的工作

1. 王嘉成：语法错误分析已完成
2. 孙子斌：目标代码生成已完成，进行整体可靠性测试
3. 边子健：代码优化器――可以运行，待调试

### 下一步的工作（――2020.7.10）

1. 待优化与活跃信息生成正式并入系统后，进行大量的测试并修正错误

## 关于个人工作

本阶段主要完成了目标代码生成部分的实现，进行了词法分析器――语义分析器――目标代码生成器的联合调试，发现错误并通知组员修改，成功修正了词法分析器的问题，同时自己解决了一些语义分析和目标代码生成的逻辑问题。

### 过程中遇到的困难

#### 1. 8086处理器的栈空间管理问题

在维护活动记录时，出现了函数调用时的压栈顺序问题。由于直接对8086的SP指针进行操作会触发内部中断，导致SP移动的路径上出现不可预料的数值，因此对活动记录结构进行了调整，将返回地址调整至形参单元之后，防止传参后修改SP指针导致参数失效。

#### 2. MASM5.0的语法特性

在MASM汇编器中，MOV R，[Address]语句会被认作立即寻址，需要特别指定段寄存器。

#### 3. 换名形参的嵌套传参问题

在函数递归调用时，将换名形参作为调用函数的换名形参传入，会出现将换名形参存储地址单元的地址传入的问题。需要具体分析，保证传入地址唯一，即源数据的地址。

#### 4. 换名形参的段地址问题

由于存在将函数局部变量作为换名形参传入的情况，不能仅记录有效地址，需要记录换名形参源数据的所在段

### 目前搁置的问题

1. 不接受表达式中数据类型的隐性转换

2. 8086的浮点型数据计算问题（不具备FPU）

3. 数组与结构体（已提供预留条件）

4. 函数可能无返回（条件分支可能走不到返回语句）， 程序可能无结束（同理）的语法错误。